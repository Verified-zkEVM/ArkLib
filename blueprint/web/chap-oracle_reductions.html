<!DOCTYPE html>
<html lang="en">
<head>
<script>
  MathJax = { 
    tex: {
		    inlineMath: [['$','$'], ['\\(','\\)']]
	} }
</script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>
<meta name="generator" content="plasTeX" />
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Oracle Reductions</title>
<link rel="next" href="chap-proof_systems.html" title="Proof Systems" />
<link rel="prev" href="sect0001.html" title="Introduction" />
<link rel="up" href="index.html" title="Formally Verified Arguments of Knowledge in Lean" />
<link rel="stylesheet" href="styles/theme-white.css" />
<link rel="stylesheet" href="styles/amsthm.css" />
<link rel="stylesheet" href="styles/pygments.css" />
<link rel="stylesheet" href="styles/showmore.css" />
<link rel="stylesheet" href="styles/blueprint.css" />
<link rel="stylesheet" href="styles/extra_styles.css" />
</head>

<body>
<header>
<svg  id="toc-toggle" class="icon icon-list-numbered "><use xlink:href="symbol-defs.svg#icon-list-numbered"></use></svg>
<h1 id="doc_title"><a href="index.html">Formally Verified Arguments of Knowledge in Lean</a></h1>
</header>

<div class="wrapper">
<nav class="toc">
<ul class="sub-toc-0">
<li class="">
  <a href="sect0001.html"><span class="toc_ref">1</span> <span class="toc_entry">Introduction</span></a>
 </li>
<li class=" active current">
  <a href="chap-oracle_reductions.html"><span class="toc_ref">2</span> <span class="toc_entry">Oracle Reductions</span></a>
  <span class="expand-toc">▼</span>
  <ul class="sub-toc-1 active">
     <li class="">
  <a href="chap-oracle_reductions.html#sec:oracle_reductions_defs"><span class="toc_ref">2.1</span> <span class="toc_entry">Definitions</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-2">
     <li class="">
  <a href="chap-oracle_reductions.html#sec:oracle_reductions_defs_format"><span class="toc_ref">2.1.1</span> <span class="toc_entry">Format</span></a>
 </li>
<li class="">
  <a href="chap-oracle_reductions.html#sec:execution_semantics"><span class="toc_ref">2.1.2</span> <span class="toc_entry">Execution Semantics</span></a>
 </li>
<li class="">
  <a href="chap-oracle_reductions.html#sec:security"><span class="toc_ref">2.1.3</span> <span class="toc_entry">Security Properties</span></a>
 </li>

  </ul>
 </li>
<li class="">
  <a href="chap-oracle_reductions.html#sec:composition_oracle_reductions"><span class="toc_ref">2.2</span> <span class="toc_entry">Composition of Oracle Reductions</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-2">
     <li class="">
  <a href="chap-oracle_reductions.html#sec:sequential_composition"><span class="toc_ref">2.2.1</span> <span class="toc_entry">Sequential Composition</span></a>
 </li>
<li class="">
  <a href="chap-oracle_reductions.html#sec:lifting_contexts"><span class="toc_ref">2.2.2</span> <span class="toc_entry">Lifting Contexts</span></a>
 </li>

  </ul>
 </li>

  </ul>
 </li>
<li class="">
  <a href="chap-proof_systems.html"><span class="toc_ref">3</span> <span class="toc_entry">Proof Systems</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-1">
     <li class="">
  <a href="chap-proof_systems.html#a0000000004"><span class="toc_ref">3.1</span> <span class="toc_entry">Simple Oracle Reductions</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-2">
     <li class="">
  <a href="chap-proof_systems.html#a0000000005"><span class="toc_ref">3.1.1</span> <span class="toc_entry">Polynomial Equality Testing</span></a>
 </li>
<li class="">
  <a href="chap-proof_systems.html#a0000000006"><span class="toc_ref">3.1.2</span> <span class="toc_entry">Batching Polynomial Evaluation Claims</span></a>
 </li>

  </ul>
 </li>
<li class="">
  <a href="chap-proof_systems.html#sec:sumcheck"><span class="toc_ref">3.2</span> <span class="toc_entry">The Sum-Check Protocol</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-2">
     <li class="">
  <a href="chap-proof_systems.html#sec:sumcheck_standard"><span class="toc_ref">3.2.1</span> <span class="toc_entry">Standard Description</span></a>
 </li>
<li class="">
  <a href="chap-proof_systems.html#sec:sumcheck_modular"><span class="toc_ref">3.2.2</span> <span class="toc_entry">Modular Description</span></a>
 </li>

  </ul>
 </li>
<li class="">
  <a href="chap-proof_systems.html#a0000000007"><span class="toc_ref">3.3</span> <span class="toc_entry">The Spartan Protocol</span></a>
 </li>
<li class="">
  <a href="chap-proof_systems.html#a0000000008"><span class="toc_ref">3.4</span> <span class="toc_entry">The Ligero Polynomial Commitment Scheme</span></a>
 </li>

  </ul>
 </li>
<li class="">
  <a href="chap-commitment_schemes.html"><span class="toc_ref">4</span> <span class="toc_entry">Commitment Schemes</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-1">
     <li class="">
  <a href="chap-commitment_schemes.html#a0000000009"><span class="toc_ref">4.1</span> <span class="toc_entry">Definitions</span></a>
 </li>
<li class="">
  <a href="chap-commitment_schemes.html#sec:merkle_trees"><span class="toc_ref">4.2</span> <span class="toc_entry">Merkle Trees</span></a>
 </li>

  </ul>
 </li>
<li class="">
  <a href="chap-supporting_theories.html"><span class="toc_ref">5</span> <span class="toc_entry">Supporting Theories</span></a>
  <span class="expand-toc">▶</span>
  <ul class="sub-toc-1">
     <li class="">
  <a href="chap-supporting_theories.html#sec:polynomials"><span class="toc_ref">5.1</span> <span class="toc_entry">Polynomials</span></a>
 </li>
<li class="">
  <a href="chap-supporting_theories.html#sec:coding_theory"><span class="toc_ref">5.2</span> <span class="toc_entry">Coding Theory</span></a>
 </li>
<li class="">
  <a href="chap-supporting_theories.html#sec:vcvio"><span class="toc_ref">5.3</span> <span class="toc_entry">The VCVio Library</span></a>
 </li>

  </ul>
 </li>
<li class="">
  <a href="chap-references.html"><span class="toc_ref">6</span> <span class="toc_entry">References</span></a>
 </li>
<li class="">
  <a href="sect0002.html"><span class="toc_ref">7</span> <span class="toc_entry">Bibliography</span></a>
 </li>
<li ><a href="dep_graph_document.html">Dependency graph</a></li>
</ul>
</nav>

<div class="content">
<div class="content-wrapper">


<div class="main-text">
<h1 id="chap:oracle_reductions">2 Oracle Reductions</h1>

<h1 id="sec:oracle_reductions_defs">2.1 Definitions</h1>

<p>In this section, we give the basic definitions of a public-coin interactive oracle reduction (henceforth called an oracle reduction or IOR). We will define its building blocks, and various security properties. </p>
<h2 id="sec:oracle_reductions_defs_format">2.1.1 Format</h2>

<p>An <b class="bfseries">(interactive) oracle reduction (IOR)</b> is an interactive protocol between two parties, a <em>prover</em> \(\mathcal{P}\) and a <em>verifier</em> \(\mathcal{V}\). In ArkLib, IORs are defined in the following setting: </p>
<ol class="enumerate">
  <li><p>We work in an ambient dependent type theory (in our case, Lean). </p>
</li>
  <li><p>The protocol flow is fixed and defined by a given <em>type signature</em>, which describes in each round which party sends a message to the other, and the type of that message. </p>
</li>
  <li><p>The prover and verifier has access to some inputs (called the <em>(oracle) context</em>) at the beginning of the protocol. These inputs are classified as follows: </p>
<ul class="itemize">
  <li><p><em>Public inputs</em> (or <em>statement</em>) \(\mathbb {x}\): available to both parties; </p>
</li>
  <li><p><em>Private inputs</em> (or <em>witness</em>) \(\mathbb {w}\): available only to the prover; </p>
</li>
  <li><p><em>Oracle inputs</em> (or <em>oracle statement</em>) \(\mathbb {ox}\): the underlying data is available to the prover, but it’s only exposed as an oracle to the verifier. See&#160;<a href="chap-oracle_reductions.html#def:oracle_interface">Definition 2</a> for more information. </p>
</li>
  <li><p><em>Shared oracle</em> \(\mathcal{O}\): the oracle is available to both parties via an interface; in most cases, it is either empty, a probabilistic sampling oracle, a random oracle, or a group oracle (for the Algebraic Group Model). See&#160;<a href="chap-supporting_theories.html#sec:vcvio">Section 5.3</a> for more information on oracle computations. </p>
</li>
</ul>
</li>
  <li><p>The messages sent from the prover may either: 1) be seen directly by the verifier, or 2) only available to a verifier through an <em>oracle interface</em> (which specifies the type for the query and response, and the oracle’s behavior given the underlying message). </p>
<p>Currently, in the oracle reduction setting, we <em>only</em> allow messages sent to be available through oracle interfaces. In the (non-oracle) reduction setting, all messages are available directly. Future extensions may allow for mixed visibility for prover’s messages. </p>
</li>
  <li><p>\(\mathcal{V}\) is assumed to be <em>public-coin</em>, meaning that its challenges are chosen uniformly at random from the finite type corresponding to that round, and it uses no randomness otherwise, except from those coming from the shared oracle. </p>
</li>
  <li><p>At the end of the protocol, the prover and verifier outputs a new (oracle) context, which consists of: </p>
<ul class="itemize">
  <li><p>The verifier takes in the input statement and the challenges, performs an <em>oracle</em> computation on the input oracle statements and the oracle messages, and outputs a new output statement. </p>
<p>The verifier also outputs the new oracle statement in an implicit manner, by specifying a subset of the input oracle statements &amp; the oracle messages. Future extensions may allow for more flexibility in specifying output oracle statements (i.e. not just a subset, but a linear combination, or any other function). </p>
</li>
  <li><p>The prover takes in some final private state (maintained during protocol execution), and outputs a new output statement, new output oracle statement, and new output witness. </p>
</li>
</ul>
</li>
</ol>
<div class="remark_thmwrapper theorem-style-definition" id="a0000000010">
  <div class="remark_thmheading">
    <span class="remark_thmcaption">
    Remark
    </span>
    <span class="remark_thmlabel">1</span>
    <span class="remark_thmtitle">Literature Comparison</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#a0000000010">#</a>
    
    
    
        </div>
  </div>
  <div class="remark_thmcontent">
  <p> In the literature, our definition corresponds to the notion of <em>functional</em> IORs. Historically, (vector) IOPs were the first notion to be introduced by&#160;<span class="cite">
	[
</span>; these are IORs where the output statement is true/false, all oracle statements and messages are vectors over some alphabet \(\Sigma \), and the oracle interfaces are for querying specific positions in the vector. More recent works have considered other oracle interfaces, e.g., polynomial oracles&#160;<span class="cite">
	[
</span>, generalized proofs to reductions&#160;<span class="cite">
	[
</span>, and considered general oracle interfaces&#160;<span class="cite">
	[
</span>. Most of the IOP theory has been distilled in the textbook&#160;<span class="cite">
	[
</span>. </p>
<p>We have not seen any work that considers our most general setting, of IORs with arbitrary oracle interfaces. </p>

  </div>
</div>
<p>We now go into more details on these objects, and how they are represented in Lean. Our description will aim to be as close as possible to the Lean code, and hence may differ somewhat from “mainstream” mathematical &amp; cryptographic notation. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:oracle_interface">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">2</span>
    <span class="definition_thmtitle">Oracle Interface</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:oracle_interface">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleInterface" class="lean_decl">OracleInterface</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  An oracle interface for an underlying data type \(\mathsf{D}\) consists of the following: </p>
<ul class="itemize">
  <li><p>A type \(\mathsf{Q}\) for queries to the oracle, </p>
</li>
  <li><p>A type \(\mathsf{R}\) for responses from the oracle, </p>
</li>
  <li><p>A function \(\mathsf{oracle} : \mathsf{D} \to \mathsf{Q} \to \mathsf{R}\) that specifies the oracle’s behavior given the underlying data and a query. </p>
</li>
</ul>


  </div>
</div>
<p>See <span class="ttfamily">OracleInterface.lean</span> for common instances of \(\mathsf{OracleInterface}\). </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:context">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">3</span>
    <span class="definition_thmtitle">Context</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:context">#</a>
    
    
    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  In an (oracle) reduction, its <em>(oracle) context</em> consists of a statement type, a witness type, and (in the oracle case) an indexed list of oracle statement types. </p>
<p>Currently, we do not abstract out / bundle the context as a separate structure, but rather specifies the types explicitly. This may change in the future. </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:protocol_spec">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">4</span>
    <span class="definition_thmtitle">Protocol Specification</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:protocol_spec">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec" class="lean_decl">ProtocolSpec</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A protocol specification for an \(n\)-message (oracle) reduction, is an element of the following type: <div class="displaymath" id="a0000000011">
  
</div> ProtocolSpec n := Fin n Direction×Type. <div class="displaymath" id="a0000000012">
  
</div> In the above, \(\mathsf{Direction}:= \{  \mathsf{P \! \! \rightarrow \! \!  V}, \mathsf{V \! \! \rightarrow \! \!  P}\} \) is the type of possible directions of messages, and \(\mathsf{Fin}\  n := \{  i : \mathbb {N}\mathbin {/\! /}i {\lt} n \} \) is the type of all natural numbers less than \(n\). </p>
<p>In other words, for each step \(i\) of interaction, the protocol specification describes the <em>direction</em> of the message sent in that step, i.e., whether it is from the prover or from the verifier. It also describes the <em>type</em> of that message. </p>
<p>In the oracle setting, we also expect an oracle interface for each message from the prover to the verifier.  </p>

  </div>
</div>
<p>We define some supporting definitions for a protocol specification. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:protocol_spec_components">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">5</span>
    <span class="definition_thmtitle">Protocol Specification Components</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:protocol_spec_components">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:protocol_spec">Definition 4</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.getDir" class="lean_decl">ProtocolSpec.getDir</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.getType" class="lean_decl">ProtocolSpec.getType</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.MessageIdx" class="lean_decl">ProtocolSpec.MessageIdx</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.ChallengeIdx" class="lean_decl">ProtocolSpec.ChallengeIdx</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.Message" class="lean_decl">ProtocolSpec.Message</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.Challenge" class="lean_decl">ProtocolSpec.Challenge</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Given a protocol spec \(\mathsf{pSpec}: \mathsf{ProtocolSpec}\  n\), we define: </p>
<ul class="itemize">
  <li><p>\(\mathsf{pSpec}.\mathsf{Dir}\  i := (\mathsf{pSpec}\  i).\mathsf{fst}\) extracts the direction of the \(i\)-th message. </p>
</li>
  <li><p>\(\mathsf{pSpec}.\mathsf{Type}\  i := (\mathsf{pSpec}\  i).\mathsf{snd}\) extracts the type of the \(i\)-th message. </p>
</li>
  <li><p>\(\mathsf{pSpec}.\mathsf{MessageIdx}:= \{ i : \mathsf{Fin}\  n \mathbin {/\! /}\mathsf{pSpec}.\mathsf{Dir}\  i = \mathsf{P \! \! \rightarrow \! \!  V}\} \) is the subtype of indices corresponding to prover messages. </p>
</li>
  <li><p>\(\mathsf{pSpec}.\mathsf{ChallengeIdx}:= \{ i : \mathsf{Fin}\  n \mathbin {/\! /}\mathsf{pSpec}.\mathsf{Dir}\  i = \mathsf{V \! \! \rightarrow \! \!  P}\} \) is the subtype of indices corresponding to verifier challenges. </p>
</li>
  <li><p>\(\mathsf{pSpec}.\mathsf{Message}\  i := (i : \mathsf{pSpec}.\mathsf{MessageIdx}) \to \mathsf{pSpec}.\mathsf{Type}\  i.\mathsf{val}\) is an indexed family of message types in the protocol. </p>
</li>
  <li><p>\(\mathsf{pSpec}.\mathsf{Challenge}\  i := (i : \mathsf{pSpec}.\mathsf{ChallengeIdx}) \to \mathsf{pSpec}.\mathsf{Type}\  i.\mathsf{val}\) is an indexed family of challenge types in the protocol. </p>
</li>
</ul>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:transcript">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">6</span>
    <span class="definition_thmtitle">Protocol Transcript</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:transcript">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:protocol_spec">Definition 4</a></li>
          
          <li><a href="chap-oracle_reductions.html#def:protocol_spec_components">Definition 5</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.Transcript" class="lean_decl">ProtocolSpec.Transcript</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.Message" class="lean_decl">ProtocolSpec.Message</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.Challenge" class="lean_decl">ProtocolSpec.Challenge</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Given protocol specification \(\mathsf{pSpec}: \mathsf{ProtocolSpec}\  n\), we define: </p>
<ul class="itemize">
  <li><p>A <em>transcript</em> up to round \(k : \mathsf{Fin}\  (n + 1)\) is an element of type </p>
<div class="displaymath" id="a0000000013">
  \[  \mathsf{Transcript}\  k\  \mathsf{pSpec}:= (i : \mathsf{Fin}\  k) \to \mathsf{pSpec}.\mathsf{Type}\  (\uparrow i : \mathsf{Fin}\  n)  \]
</div>
<p> where \(\uparrow i : \mathsf{Fin}\  n\) denotes casting \(i : \mathsf{Fin}\  k\) to \(\mathsf{Fin}\  n\) (valid since \(k \leq n + 1\)). </p>
</li>
  <li><p>A <em>full transcript</em> is \(\mathsf{FullTranscript}\  \mathsf{pSpec}:= (i : \mathsf{Fin}\  n) \to \mathsf{pSpec}.\mathsf{Type}\  i\). </p>
</li>
  <li><p>The type of all <em>messages</em> from prover to verifier is </p>
<div class="displaymath" id="a0000000014">
  \[  \mathsf{pSpec}.\mathsf{Messages}:= \prod _{i : \mathsf{pSpec}.\mathsf{MessageIdx}} \mathsf{pSpec}.\mathsf{Message}\  i  \]
</div>
</li>
  <li><p>The type of all <em>challenges</em> from verifier to prover is </p>
<div class="displaymath" id="a0000000015">
  \[  \mathsf{pSpec}.\mathsf{Challenges}:= \prod _{i : \mathsf{pSpec}.\mathsf{ChallengeIdx}} \mathsf{pSpec}.\mathsf{Challenge}\  i  \]
</div>
</li>
</ul>


  </div>
</div>
<div class="remark_thmwrapper theorem-style-definition" id="a0000000016">
  <div class="remark_thmheading">
    <span class="remark_thmcaption">
    Remark
    </span>
    <span class="remark_thmlabel">7</span>
    <span class="remark_thmtitle">Design Decision</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#a0000000016">#</a>
    
    
    
        </div>
  </div>
  <div class="remark_thmcontent">
  <p> We do not enforce a particular interaction flow in the definition of an interactive (oracle) reduction. This is done so that we can capture all protocols in the most generality. Also, we want to allow the prover to send multiple messages in a row, since each message may have a different oracle representation (for instance, in the Plonk protocol, the prover’s first message is a 3-tuple of polynomial commitments.) </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:prover">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">8</span>
    <span class="definition_thmtitle">Type Signature of a Prover</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:prover">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Prover" class="lean_decl">Prover</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProverState" class="lean_decl">ProverState</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProverIn" class="lean_decl">ProverIn</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProverRound" class="lean_decl">ProverRound</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProverOut" class="lean_decl">ProverOut</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A prover \(\mathcal{P}\) in a reduction consists of the following components: </p>
<ul class="itemize">
  <li><p><b class="bfseries">Prover State</b>: A family of types \(\mathsf{PrvState} : \mathsf{Fin}(n+1) \to \mathsf{Type}\) representing the prover’s internal state at each round of the protocol. </p>
</li>
  <li><p><b class="bfseries">Input Processing</b>: A function </p>
<div class="displaymath" id="a0000000017">
  \[  \mathsf{input} : \mathsf{StmtIn}\to \mathsf{WitIn}\to \mathsf{PrvState}(0)  \]
</div>
<p> that initializes the prover’s state from the input statement and witness. </p>
</li>
  <li><p><b class="bfseries">Message Sending</b>: For each message index \(i : \mathsf{pSpec}.\mathsf{MessageIdx}\), a function </p>
<div class="displaymath" id="a0000000018">
  \[  \mathsf{sendMessage}_i : \mathsf{PrvState}(i.\mathsf{val}.\mathsf{castSucc}) \to \mathsf{OracleComp}(\mathsf{oSpec}, \mathsf{pSpec}.\mathsf{Message}(i) \times \mathsf{PrvState}(i.\mathsf{val}.\mathsf{succ}))  \]
</div>
<p> that generates the message and updates the prover’s state. </p>
</li>
  <li><p><b class="bfseries">Challenge Processing</b>: For each challenge index \(i : \mathsf{pSpec}.\mathsf{ChallengeIdx}\), a function </p>
<div class="displaymath" id="a0000000019">
  \[  \mathsf{receiveChallenge}_i : \mathsf{PrvState}(i.\mathsf{val}.\mathsf{castSucc}) \to \mathsf{pSpec}.\mathsf{Challenge}(i) \to \mathsf{PrvState}(i.\mathsf{val}.\mathsf{succ})  \]
</div>
<p> that updates the prover’s state upon receiving a challenge. </p>
</li>
  <li><p><b class="bfseries">Output Generation</b>: A function </p>
<div class="displaymath" id="a0000000020">
  \[  \mathsf{output} : \mathsf{PrvState}(\mathsf{Fin}.\mathsf{last}(n)) \to \mathsf{StmtOut}\times \mathsf{WitOut} \]
</div>
<p> that produces the final output statement and witness from the prover’s final state. </p>
</li>
</ul>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:oracle_prover">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">9</span>
    <span class="definition_thmtitle">Type Signature of an Oracle Prover</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:oracle_prover">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleProver" class="lean_decl">OracleProver</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  An oracle prover is a prover whose input statement includes the underlying data for oracle statements, and whose output includes oracle statements. Formally, it is a prover with input statement type \(\mathsf{StmtIn}\times (\forall i : \iota _{\mathsf{si}}, \mathsf{OStmtIn}(i))\) and output statement type \(\mathsf{StmtOut}\times (\forall i : \iota _{\mathsf{so}}, \mathsf{OStmtOut}(i))\), where: </p>
<ul class="itemize">
  <li><p>\(\mathsf{OStmtIn}: \iota _{\mathsf{si}} \to \mathsf{Type}\) are the input oracle statement types </p>
</li>
  <li><p>\(\mathsf{OStmtOut}: \iota _{\mathsf{so}} \to \mathsf{Type}\) are the output oracle statement types </p>
</li>
</ul>


  </div>
</div>
<p>After the interaction phase, the verifier may then run some verification procedure to check the validity of the prover’s responses. In this procedure, the verifier gets access to the public part of the context, and oracle access to either the shared oracle, or the oracle inputs. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:verifier">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">10</span>
    <span class="definition_thmtitle">Type Signature of a Verifier</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:verifier">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier" class="lean_decl">Verifier</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A verifier \(\mathcal{V}\) in a reduction is specified by a single function: </p>
<div class="displaymath" id="a0000000021">
  \[  \mathsf{verify} : \mathsf{StmtIn}\to \mathsf{FullTranscript}(\mathsf{pSpec}) \to \mathsf{OracleComp}(\mathsf{oSpec}, \mathsf{StmtOut})  \]
</div>
<p>This function takes the input statement and the complete transcript of the protocol interaction, and performs an oracle computation (potentially querying the shared oracle \(\mathsf{oSpec}\)) to produce an output statement. </p>
<p>The verifier is assumed to be <em>public-coin</em>, meaning it only sends uniformly random challenges and uses no other randomness beyond what is provided by the shared oracle.  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:oracle_verifier">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">11</span>
    <span class="definition_thmtitle">Type Signature of an Oracle Verifier</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:oracle_verifier">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleVerifier" class="lean_decl">OracleVerifier</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  An oracle verifier \(\mathcal{V}\) consists of the following components: </p>
<ul class="itemize">
  <li><p><b class="bfseries">Verification Logic</b>: A function </p>
<div class="displaymath" id="a0000000022">
  \[  \mathsf{verify} : \mathsf{StmtIn}\to \mathsf{pSpec}.\mathsf{Challenges}\to \mathsf{OracleComp}(\mathsf{oSpec}\mathrel {++_\mathsf {o}} ([\mathsf{OStmtIn}]_\mathsf {o} \mathrel {++_\mathsf {o}} [\mathsf{pSpec}.\mathsf{Message}]_\mathsf {o}), \mathsf{StmtOut})  \]
</div>
<p> that takes the input statement and verifier challenges, and performs oracle queries to the shared oracle, input oracle statements, and prover messages to produce an output statement. </p>
</li>
  <li><p><b class="bfseries">Output Oracle Embedding</b>: An injective function </p>
<div class="displaymath" id="a0000000023">
  \[  \mathsf{embed} : \iota _{\mathsf{so}} \hookrightarrow \iota _{\mathsf{si}} \oplus \mathsf{pSpec}.\mathsf{MessageIdx} \]
</div>
<p> that specifies how each output oracle statement is derived from either an input oracle statement or a prover message. </p>
</li>
  <li><p><b class="bfseries">Type Compatibility</b>: A proof term </p>
<div class="displaymath" id="a0000000024">
  \[  \mathsf{hEq} : \forall i : \iota _{\mathsf{so}}, \mathsf{OStmtOut}(i) = \begin{cases} \end{cases} \mathsf{OStmtIn}(j) &  \text{if } \mathsf{embed}(i) = \mathsf{inl}(j) \\ \mathsf{pSpec}.\mathsf{Message}(k) &  \text{if } \mathsf{embed}(i) = \mathsf{inr}(k) \end{cases}  \]
</div>
<p> ensuring that output oracle statement types match their sources. </p>
</li>
</ul>
<p>This design ensures that output oracle statements are always a subset of the available input oracle statements and prover messages.  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:oracle_verifier_to_verifier">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">12</span>
    <span class="definition_thmtitle">Oracle Verifier to Verifier Conversion</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:oracle_verifier_to_verifier">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:oracle_verifier">Definition 11</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleVerifier.toVerifier" class="lean_decl">OracleVerifier.toVerifier</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  An oracle verifier can be converted to a standard verifier through a natural simulation process. The key insight is that while an oracle verifier only has oracle access to certain data (input oracle statements and prover messages), a standard verifier can be given the actual underlying data directly. </p>
<p>The conversion works as follows: when the oracle verifier needs to make an oracle query to some data, the converted verifier can respond to this query immediately using the actual underlying data it possesses. This is accomplished through the <span class="ttfamily">OracleInterface</span> type class, which specifies for each data type how to respond to queries given the underlying data. </p>
<p>Specifically, given an oracle verifier \(\mathcal{V}_{\text{oracle}}\): </p>
<ul class="itemize">
  <li><p>The converted verifier \(\mathcal{V}_{\text{oracle}}.\mathsf{toVerifier}\) takes as input both the statement <em>and</em> the actual underlying data for all oracle statements </p>
</li>
  <li><p>When \(\mathcal{V}_{\text{oracle}}\) attempts to query an oracle statement or prover message, the converted verifier uses the corresponding <span class="ttfamily">OracleInterface</span> instance to compute the response from the actual data </p>
</li>
  <li><p>The output oracle statements are constructed according to the embedding specification, selecting the appropriate subset of input oracle statements and prover messages </p>
</li>
</ul>


  </div>
</div>
<p>An oracle reduction then consists of a type signature for the interaction, and a pair of prover and verifier for that type signature. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:interactive_reduction">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">13</span>
    <span class="definition_thmtitle">Interactive Reduction</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:interactive_reduction">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:prover">Definition 8</a></li>
          
          <li><a href="chap-oracle_reductions.html#def:verifier">Definition 10</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction" class="lean_decl">Reduction</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  An interactive reduction for protocol specification \(\mathsf{pSpec}: \mathsf{ProtocolSpec}(n)\) and oracle specification \(\mathsf{oSpec}\) consists of: </p>
<ul class="itemize">
  <li><p>A <b class="bfseries">prover</b> \(\mathcal{P} : \mathsf{Prover}(\mathsf{pSpec}, \mathsf{oSpec}, \mathsf{StmtIn}, \mathsf{WitIn}, \mathsf{StmtOut}, \mathsf{WitOut})\) </p>
</li>
  <li><p>A <b class="bfseries">verifier</b> \(\mathcal{V} : \mathsf{Verifier}(\mathsf{pSpec}, \mathsf{oSpec}, \mathsf{StmtIn}, \mathsf{StmtOut})\) </p>
</li>
</ul>
<p>The reduction establishes a relationship between input relations on \((\mathsf{StmtIn}, \mathsf{WitIn})\) and output relations on \((\mathsf{StmtOut}, \mathsf{WitOut})\) through the interactive protocol defined by \(\mathsf{pSpec}\).   </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:interactive_oracle_reduction">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">14</span>
    <span class="definition_thmtitle">Interactive Oracle Reduction</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:interactive_oracle_reduction">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:oracle_prover">Definition 9</a></li>
          
          <li><a href="chap-oracle_reductions.html#def:oracle_verifier">Definition 11</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleReduction" class="lean_decl">OracleReduction</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  An interactive oracle reduction for protocol specification \(\mathsf{pSpec}: \mathsf{ProtocolSpec}(n)\) with oracle interfaces for all prover messages, and oracle specification \(\mathsf{oSpec}\), consists of: </p>
<ul class="itemize">
  <li><p>An <b class="bfseries">oracle prover</b> \(\mathcal{P} : \mathsf{OracleProver}(\mathsf{pSpec}, \mathsf{oSpec}, \mathsf{StmtIn}, \mathsf{WitIn}, \mathsf{StmtOut}, \mathsf{WitOut}, \mathsf{OStmtIn}, \mathsf{OStmtOut})\) </p>
</li>
  <li><p>An <b class="bfseries">oracle verifier</b> \(\mathcal{V} : \mathsf{OracleVerifier}(\mathsf{pSpec}, \mathsf{oSpec}, \mathsf{StmtIn}, \mathsf{StmtOut}, \mathsf{OStmtIn}, \mathsf{OStmtOut})\) </p>
</li>
</ul>
<p>where: </p>
<ul class="itemize">
  <li><p>\(\mathsf{OStmtIn}: \iota _{\mathsf{si}} \to \mathsf{Type}\) are the input oracle statement types with oracle interfaces </p>
</li>
  <li><p>\(\mathsf{OStmtOut}: \iota _{\mathsf{so}} \to \mathsf{Type}\) are the output oracle statement types </p>
</li>
</ul>
<p>The oracle reduction allows the verifier to access prover messages and oracle statements only through specified oracle interfaces, enabling more flexible and composable protocol designs.   </p>

  </div>
</div>
<h2 id="sec:execution_semantics">2.1.2 Execution Semantics</h2>

<p>We now define what it means to execute an oracle reduction. This is essentially achieved by first executing the prover, interspersed with oracle queries to get the verifier’s challenges (these will be given uniform random probability semantics later on), and then executing the verifier’s checks. Any message exchanged in the protocol will be added to the context. We may also log information about the execution, such as the log of oracle queries for the shared oracles, for analysis purposes (i.e. feeding information into the extractor). </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:prover_run_to_round">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">15</span>
    <span class="definition_thmtitle">Prover Execution to Round</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:prover_run_to_round">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Prover.runToRound" class="lean_decl">Prover.runToRound</a></li>
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Prover.processRound" class="lean_decl">Prover.processRound</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  The execution of a prover up to round \(i : \mathsf{Fin}(n+1)\) is defined inductively: </p>
<div class="displaymath" id="a0000000025">
  \[  \mathsf{Prover}.\mathsf{runToRound}(i, \mathsf{stmt}, \mathsf{wit}) :=  \]
</div>
<div class="displaymath" id="a0000000026">
  \[  \mathsf{Fin}.\mathsf{induction}(  \]
</div>
<div class="displaymath" id="a0000000027">
  \[  \quad \mathsf{pure}(\langle \mathsf{default}, \mathsf{prover}.\mathsf{input}(\mathsf{stmt}, \mathsf{wit}) \rangle ),  \]
</div>
<div class="displaymath" id="a0000000028">
  \[  \quad \mathsf{prover}.\mathsf{processRound},  \]
</div>
<div class="displaymath" id="a0000000029">
  \[  \quad i  \]
</div>
<div class="displaymath" id="a0000000030">
  \[  )  \]
</div>
<p>where \(\mathsf{processRound}\) handles individual rounds by either: </p>
<ul class="itemize">
  <li><p><b class="bfseries">Verifier Challenge</b> (\(\mathsf{pSpec}.\mathsf{getDir}(j) = \mathsf{V\_ to\_ P}\)): Query for a challenge and update prover state </p>
</li>
  <li><p><b class="bfseries">Prover Message</b> (\(\mathsf{pSpec}.\mathsf{getDir}(j) = \mathsf{P\_ to\_ V}\)): Generate message via \(\mathsf{sendMessage}\) and update state </p>
</li>
</ul>
<p>Returns the transcript up to round \(i\) and the prover’s state after round \(i\).  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:prover_run">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">16</span>
    <span class="definition_thmtitle">Complete Prover Execution</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:prover_run">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:prover_run_to_round">Definition 15</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Prover.run" class="lean_decl">Prover.run</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  The complete execution of a prover is defined as: </p>
<div class="displaymath" id="a0000000031">
  \[  \mathsf{Prover}.\mathsf{run}(\mathsf{stmt}, \mathsf{wit}) := \mathsf{do} \;  \{   \]
</div>
<div class="displaymath" id="a0000000032">
  \[  \quad \langle \mathsf{transcript}, \mathsf{state} \rangle \leftarrow \mathsf{prover}.\mathsf{runToRound}(\mathsf{Fin}.\mathsf{last}(n), \mathsf{stmt}, \mathsf{wit})  \]
</div>
<div class="displaymath" id="a0000000033">
  \[  \quad \langle \mathsf{stmtOut}, \mathsf{witOut} \rangle := \mathsf{prover}.\mathsf{output}(\mathsf{state})  \]
</div>
<div class="displaymath" id="a0000000034">
  \[  \quad \mathsf{return} \;  \langle \mathsf{stmtOut}, \mathsf{witOut}, \mathsf{transcript} \rangle  \]
</div>
<div class="displaymath" id="a0000000035">
  \[  \}   \]
</div>
<p>Returns the output statement, output witness, and complete transcript.   </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:verifier_run">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">17</span>
    <span class="definition_thmtitle">Verifier Execution</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:verifier_run">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.run" class="lean_decl">Verifier.run</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  The execution of a verifier is simply the application of its verification function: </p>
<div class="displaymath" id="a0000000036">
  \[  \mathsf{Verifier}.\mathsf{run}(\mathsf{stmt}, \mathsf{transcript}) := \mathsf{verifier}.\mathsf{verify}(\mathsf{stmt}, \mathsf{transcript})  \]
</div>
<p>This takes the input statement and full transcript, and returns the output statement via an oracle computation.  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:oracle_verifier_run">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">18</span>
    <span class="definition_thmtitle">Oracle Verifier Execution</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:oracle_verifier_run">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleVerifier.run" class="lean_decl">OracleVerifier.run</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  The execution of an oracle verifier is defined as: </p>
<div class="displaymath" id="a0000000037">
  \[  \mathsf{OracleVerifier}.\mathsf{run}(\mathsf{stmt}, \mathsf{oStmtIn}, \mathsf{transcript}) := \mathsf{do} \;  \{   \]
</div>
<div class="displaymath" id="a0000000038">
  \[  \quad \mathsf{f} := \mathsf{simOracle2}(\mathsf{oSpec}, \mathsf{oStmtIn}, \mathsf{transcript}.\mathsf{messages})  \]
</div>
<div class="displaymath" id="a0000000039">
  \[  \quad \mathsf{stmtOut} \leftarrow \mathsf{simulateQ}(\mathsf{f}, \mathsf{verifier}.\mathsf{verify}(\mathsf{stmt}, \mathsf{transcript}.\mathsf{challenges}))  \]
</div>
<div class="displaymath" id="a0000000040">
  \[  \quad \mathsf{return} \;  \mathsf{stmtOut}  \]
</div>
<div class="displaymath" id="a0000000041">
  \[  \}   \]
</div>
<p>This simulates the oracle access to input oracle statements and prover messages, then executes the verification logic.  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:reduction_run">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">19</span>
    <span class="definition_thmtitle">Interactive Reduction Execution</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:reduction_run">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:prover_run">Definition 16</a></li>
          
          <li><a href="chap-oracle_reductions.html#def:verifier_run">Definition 17</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.run" class="lean_decl">Reduction.run</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  The execution of an interactive reduction consists of running the prover followed by the verifier: </p>
<div class="displaymath" id="a0000000042">
  \[  \mathsf{Reduction}.\mathsf{run}(\mathsf{stmt}, \mathsf{wit}) := \mathsf{do} \;  \{   \]
</div>
<div class="displaymath" id="a0000000043">
  \[  \quad \langle \mathsf{prvStmtOut}, \mathsf{witOut}, \mathsf{transcript} \rangle \leftarrow \mathsf{reduction}.\mathsf{prover}.\mathsf{run}(\mathsf{stmt}, \mathsf{wit})  \]
</div>
<div class="displaymath" id="a0000000044">
  \[  \quad \mathsf{stmtOut} \leftarrow \mathsf{reduction}.\mathsf{verifier}.\mathsf{run}(\mathsf{stmt}, \mathsf{transcript})  \]
</div>
<div class="displaymath" id="a0000000045">
  \[  \quad \mathsf{return} \;  ((\mathsf{prvStmtOut}, \mathsf{witOut}), \mathsf{stmtOut}, \mathsf{transcript})  \]
</div>
<div class="displaymath" id="a0000000046">
  \[  \}   \]
</div>
<p>Returns both the prover’s output (statement and witness) and the verifier’s output statement, along with the complete transcript.   </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:oracle_reduction_run">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">20</span>
    <span class="definition_thmtitle">Oracle Reduction Execution</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:oracle_reduction_run">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:oracle_verifier_run">Definition 18</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleReduction.run" class="lean_decl">OracleReduction.run</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  The execution of an interactive oracle reduction is similar to a standard reduction but includes logging of oracle queries: </p>
<div class="displaymath" id="a0000000047">
  \[  \mathsf{OracleReduction}.\mathsf{run}(\mathsf{stmt}, \mathsf{wit}, \mathsf{oStmt}) := \mathsf{do} \;  \{   \]
</div>
<div class="displaymath" id="a0000000048">
  \[  \quad \langle \langle \mathsf{prvStmtOut}, \mathsf{witOut}, \mathsf{transcript} \rangle , \mathsf{proveQueryLog} \rangle \leftarrow  \]
</div>
<div class="displaymath" id="a0000000049">
  \[  \qquad (\mathsf{simulateQ}(\mathsf{loggingOracle}, \mathsf{reduction}.\mathsf{prover}.\mathsf{run}(\langle \mathsf{stmt}, \mathsf{oStmt} \rangle , \mathsf{wit}))).\mathsf{run}  \]
</div>
<div class="displaymath" id="a0000000050">
  \[  \quad \langle \mathsf{stmtOut}, \mathsf{verifyQueryLog} \rangle \leftarrow  \]
</div>
<div class="displaymath" id="a0000000051">
  \[  \qquad (\mathsf{simulateQ}(\mathsf{loggingOracle}, \mathsf{reduction}.\mathsf{verifier}.\mathsf{run}(\mathsf{stmt}, \mathsf{oStmt}, \mathsf{transcript}))).\mathsf{run}  \]
</div>
<div class="displaymath" id="a0000000052">
  \[  \quad \mathsf{return} \;  ((\mathsf{prvStmtOut}, \mathsf{witOut}), \mathsf{stmtOut}, \mathsf{transcript}, \mathsf{proveQueryLog}, \mathsf{verifyQueryLog})  \]
</div>
<div class="displaymath" id="a0000000053">
  \[  \}   \]
</div>
<p>Returns the same outputs as a standard reduction, plus logs of all oracle queries made by both the prover and verifier.   </p>

  </div>
</div>
<h2 id="sec:security">2.1.3 Security Properties</h2>

<p>We can now define properties of interactive reductions. The two main properties we consider in this project are completeness and various notions of soundness. We will cover zero-knowledge at a later stage. </p>
<p>First, for completeness, this is essentially probabilistic Hoare-style conditions on the execution of the oracle reduction (with the honest prover and verifier). In other words, given a predicate on the initial context, and a predicate on the final context, we require that if the initial predicate holds, then the final predicate holds with high probability (except for some <em>completeness</em> error). </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:completeness">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">21</span>
    <span class="definition_thmtitle">Completeness</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:completeness">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:interactive_oracle_reduction">Definition 14</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.completeness" class="lean_decl">Reduction.completeness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<p>Almost all oracle reductions we consider actually satisfy <em>perfect completeness</em>, which simplifies the proof obligation. In particular, this means we only need to show that no matter what challenges are chosen, the verifier will always accept given messages from the honest prover. </p>
<p>For soundness, we need to consider different notions. These notions differ in two main aspects: </p>
<ul class="itemize">
  <li><p>Whether we consider the plain soundness, or knowledge soundness. The latter relies on the notion of an <em>extractor</em>. </p>
</li>
  <li><p>Whether we consider plain, state-restoration, round-by-round, or rewinding notion of soundness. </p>
</li>
</ul>
<p>We note that state-restoration knowledge soundness is necessary for the security of the SNARK protocol obtained from the oracle reduction after composing with a commitment scheme and applying the Fiat-Shamir transform. It in turn is implied by either round-by-round knowledge soundness, or special soundness (via rewinding). At the moment, we only care about non-rewinding soundness, so mostly we will care about round-by-round knowledge soundness. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:soundness">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">22</span>
    <span class="definition_thmtitle">Soundness</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:soundness">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:interactive_oracle_reduction">Definition 14</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.soundness" class="lean_decl">Verifier.soundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<p>A (straightline) extractor for knowledge soundness is a deterministic algorithm that takes in the output public context after executing the oracle reduction, the side information (i.e. log of oracle queries from the malicious prover) observed during execution, and outputs the witness for the input context. </p>
<p>Note that since we assume the context is append-only, and we append only the public (or oracle) messages obtained during protocol execution, it follows that the witness stays the same throughout the execution. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:knowledge_soundness">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">23</span>
    <span class="definition_thmtitle">Knowledge Soundness</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:knowledge_soundness">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:interactive_oracle_reduction">Definition 14</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.knowledgeSoundness" class="lean_decl">Verifier.knowledgeSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<p>To define round-by-round (knowledge) soundness, we need to define the notion of a <em>state function</em>. This is a (possibly inefficient) function \(\mathsf{StateF}\) that, for every challenge sent by the verifier, takes in the transcript of the protocol so far and outputs whether the state is doomed or not. Roughly speaking, the requirement of round-by-round soundness is that, for any (possibly malicious) prover \(P\), if the state function outputs that the state is doomed on some partial transcript of the protocol, then the verifier will reject with high probability. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:state_function">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">24</span>
    <span class="definition_thmtitle">State Function</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:state_function">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.StateFunction" class="lean_decl">Verifier.StateFunction</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:round_by_round_soundness">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">25</span>
    <span class="definition_thmtitle">Round-by-Round Soundness</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:round_by_round_soundness">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:interactive_oracle_reduction">Definition 14</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.rbrSoundness" class="lean_decl">Verifier.rbrSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:round_by_round_knowledge_soundness">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">26</span>
    <span class="definition_thmtitle">Round-by-Round Knowledge Soundness</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:round_by_round_knowledge_soundness">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:interactive_oracle_reduction">Definition 14</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.rbrKnowledgeSoundness" class="lean_decl">Verifier.rbrKnowledgeSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<h1 id="sec:composition_oracle_reductions">2.2 Composition of Oracle Reductions</h1>

<p>In this section, we describe a suite of composition operators for building secure oracle reductions from simpler secure components. In other words, we define a number of definitions that govern how oracle reductions can be composed to form larger reductions, and how the resulting reduction inherits the security properties of the components. </p>
<h2 id="sec:sequential_composition">2.2.1 Sequential Composition</h2>

<p>Sequential composition allows us to chain together oracle reductions where the output context of one reduction becomes the input context of the next reduction. This is fundamental for building complex protocols from simpler components. </p>
<h3 id="a0000000054">Composition of Protocol Specifications</h3>
<p>We begin by defining how to compose protocol specifications and their associated structures. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:protocol_spec_append">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">27</span>
    <span class="definition_thmtitle">Protocol Specification Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:protocol_spec_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.append" class="lean_decl">ProtocolSpec.append</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Given two protocol specifications \(\mathsf{pSpec}_1 : \mathsf{ProtocolSpec}\  m\) and \(\mathsf{pSpec}_2 : \mathsf{ProtocolSpec}\  n\), their sequential composition is: </p>
<div class="displaymath" id="a0000000055">
  \[  \mathsf{pSpec}_1 \mathrel {++_\mathsf {p}} \mathsf{pSpec}_2 : \mathsf{ProtocolSpec}\  (m + n)  \]
</div>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:full_transcript_append">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">28</span>
    <span class="definition_thmtitle">Full Transcript Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:full_transcript_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.FullTranscript.append" class="lean_decl">ProtocolSpec.FullTranscript.append</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Given full transcripts \(T_1 : \mathsf{FullTranscript}\  \mathsf{pSpec}_1\) and \(T_2 : \mathsf{FullTranscript}\  \mathsf{pSpec}_2\), their sequential composition is: </p>
<div class="displaymath" id="a0000000056">
  \[  T_1 \mathrel {++_\mathsf {t}} T_2 : \mathsf{FullTranscript}\  (\mathsf{pSpec}_1 \mathrel {++_\mathsf {p}} \mathsf{pSpec}_2)  \]
</div>


  </div>
</div>
<h3 id="a0000000057">Composition of Provers and Verifiers</h3>
<div class="definition_thmwrapper theorem-style-definition" id="def:prover_append">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">29</span>
    <span class="definition_thmtitle">Prover Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:prover_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Prover.append" class="lean_decl">Prover.append</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Given provers \(P_1 : \mathsf{Prover}\  \mathsf{pSpec}_1\  \mathsf{oSpec}\  \mathsf{StmtIn}_1\  \mathsf{WitIn}_1\  \mathsf{StmtOut}_1\  \mathsf{WitOut}_1\) and \(P_2 : \mathsf{Prover}\  \mathsf{pSpec}_2\  \mathsf{oSpec}\  \mathsf{StmtOut}_1\  \mathsf{WitOut}_1\  \mathsf{StmtOut}_2\  \mathsf{WitOut}_2\), their sequential composition is: </p>
<div class="displaymath" id="a0000000058">
  \[  P_1.\mathsf{append}\  P_2 : \mathsf{Prover}\  (\mathsf{pSpec}_1 \mathrel {++_\mathsf {p}} \mathsf{pSpec}_2)\  \mathsf{oSpec}\  \mathsf{StmtIn}_1\  \mathsf{WitIn}_1\  \mathsf{StmtOut}_2\  \mathsf{WitOut}_2  \]
</div>
<p>The composed prover works by: </p>
<ul class="itemize">
  <li><p>Running \(P_1\) on the input context to produce an intermediate context </p>
</li>
  <li><p>Using this intermediate context as input to \(P_2\) </p>
</li>
  <li><p>Outputting the final context from \(P_2\) </p>
</li>
</ul>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:verifier_append">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">30</span>
    <span class="definition_thmtitle">Verifier Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:verifier_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.append" class="lean_decl">Verifier.append</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Given verifiers \(V_1 : \mathsf{Verifier}\  \mathsf{pSpec}_1\  \mathsf{oSpec}\  \mathsf{StmtIn}_1\  \mathsf{StmtOut}_1\) and \(V_2 : \mathsf{Verifier}\  \mathsf{pSpec}_2\  \mathsf{oSpec}\  \mathsf{StmtOut}_1\  \mathsf{StmtOut}_2\), their sequential composition is: </p>
<div class="displaymath" id="a0000000059">
  \[  V_1.\mathsf{append}\  V_2 : \mathsf{Verifier}\  (\mathsf{pSpec}_1 \mathrel {++_\mathsf {p}} \mathsf{pSpec}_2)\  \mathsf{oSpec}\  \mathsf{StmtIn}_1\  \mathsf{StmtOut}_2  \]
</div>
<p>The composed verifier first runs \(V_1\) on the first part of the transcript, then runs \(V_2\) on the second part using the intermediate statement from \(V_1\).  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:reduction_append">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">31</span>
    <span class="definition_thmtitle">Reduction Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:reduction_append">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:prover_append">Definition 29</a></li>
          
          <li><a href="chap-oracle_reductions.html#def:verifier_append">Definition 30</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.append" class="lean_decl">Reduction.append</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Sequential composition of reductions combines the corresponding provers and verifiers: </p>
<div class="displaymath" id="a0000000060">
  \[  R_1.\mathsf{append}\  R_2 : \mathsf{Reduction}\  (\mathsf{pSpec}_1 \mathrel {++_\mathsf {p}} \mathsf{pSpec}_2)\  \mathsf{oSpec}\  \mathsf{StmtIn}_1\  \mathsf{WitIn}_1\  \mathsf{StmtOut}_2\  \mathsf{WitOut}_2  \]
</div>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:oracle_reduction_append">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">32</span>
    <span class="definition_thmtitle">Oracle Reduction Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:oracle_reduction_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleReduction.append" class="lean_decl">OracleReduction.append</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Sequential composition extends naturally to oracle reductions by composing the oracle provers and oracle verifiers.  </p>

  </div>
</div>
<h3 id="a0000000061">General Sequential Composition</h3>
<p>For composing an arbitrary number of reductions, we provide a general composition operation. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:protocol_spec_compose">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">33</span>
    <span class="definition_thmtitle">General Protocol Specification Composition</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:protocol_spec_compose">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ProtocolSpec.compose" class="lean_decl">ProtocolSpec.compose</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Given a family of protocol specifications \(\mathsf{pSpec}: \forall i : \mathsf{Fin}(m+1), \mathsf{ProtocolSpec}\  (n\  i)\), their composition is: </p>
<div class="displaymath" id="a0000000062">
  \[  \mathsf{compose}\  m\  n\  \mathsf{pSpec}: \mathsf{ProtocolSpec}\  (\sum _{i} n\  i)  \]
</div>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:prover_compose">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">34</span>
    <span class="definition_thmtitle">General Prover Composition</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:prover_compose">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:protocol_spec_compose">Definition 33</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Prover.compose" class="lean_decl">Prover.compose</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:verifier_compose">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">35</span>
    <span class="definition_thmtitle">General Verifier Composition</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:verifier_compose">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:protocol_spec_compose">Definition 33</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.compose" class="lean_decl">Verifier.compose</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:reduction_compose">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">36</span>
    <span class="definition_thmtitle">General Reduction Composition</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:reduction_compose">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:prover_compose">Definition 34</a></li>
          
          <li><a href="chap-oracle_reductions.html#def:verifier_compose">Definition 35</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.compose" class="lean_decl">Reduction.compose</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<h3 id="a0000000063">Security Properties of Sequential Composition</h3>
<p>The key insight is that security properties are preserved under sequential composition. </p>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:completeness_append">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">37</span>
    <span class="theorem_thmtitle">Completeness Preservation under Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:completeness_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.completeness_append" class="lean_decl">Reduction.completeness_append</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If reductions \(R_1\) and \(R_2\) satisfy completeness with compatible relations and respective errors \(\epsilon _1\) and \(\epsilon _2\), then their sequential composition \(R_1.\mathsf{append}\  R_2\) satisfies completeness with error \(\epsilon _1 + \epsilon _2\).  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:perfect_completeness_append">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">38</span>
    <span class="theorem_thmtitle">Perfect Completeness Preservation under Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:perfect_completeness_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.perfectCompleteness_append" class="lean_decl">Reduction.perfectCompleteness_append</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If reductions \(R_1\) and \(R_2\) satisfy perfect completeness with compatible relations, then their sequential composition also satisfies perfect completeness.  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:soundness_append">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">39</span>
    <span class="theorem_thmtitle">Soundness Preservation under Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:soundness_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.append_soundness" class="lean_decl">Verifier.append_soundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If verifiers \(V_1\) and \(V_2\) satisfy soundness with respective errors \(\epsilon _1\) and \(\epsilon _2\), then their sequential composition satisfies soundness with error \(\epsilon _1 + \epsilon _2\).  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:knowledge_soundness_append">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">40</span>
    <span class="theorem_thmtitle">Knowledge Soundness Preservation under Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:knowledge_soundness_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.append_knowledgeSoundness" class="lean_decl">Verifier.append_knowledgeSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If verifiers \(V_1\) and \(V_2\) satisfy knowledge soundness with respective errors \(\epsilon _1\) and \(\epsilon _2\), then their sequential composition satisfies knowledge soundness with error \(\epsilon _1 + \epsilon _2\).  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:rbr_soundness_append">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">41</span>
    <span class="theorem_thmtitle">Round-by-Round Soundness Preservation under Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:rbr_soundness_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.append_rbrSoundness" class="lean_decl">Verifier.append_rbrSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If verifiers \(V_1\) and \(V_2\) satisfy round-by-round soundness, then their sequential composition also satisfies round-by-round soundness.  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:rbr_knowledge_soundness_append">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">42</span>
    <span class="theorem_thmtitle">Round-by-Round Knowledge Soundness Preservation under Append</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:rbr_knowledge_soundness_append">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.append_rbrKnowledgeSoundness" class="lean_decl">Verifier.append_rbrKnowledgeSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If verifiers \(V_1\) and \(V_2\) satisfy round-by-round knowledge soundness, then their sequential composition also satisfies round-by-round knowledge soundness.  </p>

  </div>
</div>
<p>Similar preservation theorems hold for the general composition of multiple reductions: </p>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:completeness_compose">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">43</span>
    <span class="theorem_thmtitle">General Completeness Preservation</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:completeness_compose">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.completeness_compose" class="lean_decl">Reduction.completeness_compose</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:soundness_compose">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">44</span>
    <span class="theorem_thmtitle">General Soundness Preservation</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:soundness_compose">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.compose_soundness" class="lean_decl">Verifier.compose_soundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:knowledge_soundness_compose">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">45</span>
    <span class="theorem_thmtitle">General Knowledge Soundness Preservation</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:knowledge_soundness_compose">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.compose_knowledgeSoundness" class="lean_decl">Verifier.compose_knowledgeSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  

  </div>
</div>
<h2 id="sec:lifting_contexts">2.2.2 Lifting Contexts</h2>

<p>Another essential tool for modular oracle reductions is the ability to adapt reductions from one context to another. This allows us to apply reductions designed for simple contexts to more complex scenarios. </p>
<h3 id="a0000000064">Context Lenses</h3>
<p>The fundamental abstraction for context adaptation is a <em>context lens</em>, which provides bidirectional mappings between outer and inner contexts. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:statement_lens">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">46</span>
    <span class="definition_thmtitle">Statement Lens</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:statement_lens">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/StatementLens" class="lean_decl">StatementLens</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A statement lens between outer context types \((\mathsf{StmtIn}_{\mathsf{outer}}, \mathsf{StmtOut}_{\mathsf{outer}})\) and inner context types \((\mathsf{StmtIn}_{\mathsf{inner}}, \mathsf{StmtOut}_{\mathsf{inner}})\) consists of: </p>
<ul class="itemize">
  <li><p>\(\mathsf{projStmt}: \mathsf{StmtIn}_{\mathsf{outer}} \to \mathsf{StmtIn}_{\mathsf{inner}}\) (projection to inner context) </p>
</li>
  <li><p>\(\mathsf{liftStmt}: \mathsf{StmtIn}_{\mathsf{outer}} \times \mathsf{StmtOut}_{\mathsf{inner}} \to \mathsf{StmtOut}_{\mathsf{outer}}\) (lifting back to outer context) </p>
</li>
</ul>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:witness_lens">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">47</span>
    <span class="definition_thmtitle">Witness Lens</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:witness_lens">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/WitnessLens" class="lean_decl">WitnessLens</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A witness lens between outer witness types \((\mathsf{WitIn}_{\mathsf{outer}}, \mathsf{WitOut}_{\mathsf{outer}})\) and inner witness types \((\mathsf{WitIn}_{\mathsf{inner}}, \mathsf{WitOut}_{\mathsf{inner}})\) consists of: </p>
<ul class="itemize">
  <li><p>\(\mathsf{projWit}: \mathsf{WitIn}_{\mathsf{outer}} \to \mathsf{WitIn}_{\mathsf{inner}}\) (projection to inner context) </p>
</li>
  <li><p>\(\mathsf{liftWit}: \mathsf{WitIn}_{\mathsf{outer}} \times \mathsf{WitOut}_{\mathsf{inner}} \to \mathsf{WitOut}_{\mathsf{outer}}\) (lifting back to outer context) </p>
</li>
</ul>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:context_lens">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">48</span>
    <span class="definition_thmtitle">Context Lens</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:context_lens">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:statement_lens">Definition 46</a></li>
          
          <li><a href="chap-oracle_reductions.html#def:witness_lens">Definition 47</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ContextLens" class="lean_decl">ContextLens</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A context lens combines a statement lens and a witness lens for adapting complete reduction contexts.   </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:oracle_context_lens">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">49</span>
    <span class="definition_thmtitle">Oracle Context Lens</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:oracle_context_lens">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:context_lens">Definition 48</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/OracleContextLens" class="lean_decl">OracleContextLens</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  For oracle reductions, we additionally need lenses for oracle statements that can simulate oracle access between contexts.   </p>

  </div>
</div>
<h3 id="a0000000065">Lifting Reductions</h3>
<p>Given a context lens, we can lift reductions from inner contexts to outer contexts. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:prover_lift_context">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">50</span>
    <span class="definition_thmtitle">Prover Context Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:prover_lift_context">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Prover.liftContext" class="lean_decl">Prover.liftContext</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  Given a prover \(P\) for the inner context and a context lens, the lifted prover works by: </p>
<ul class="itemize">
  <li><p>Projecting the outer input to the inner context </p>
</li>
  <li><p>Running the inner prover </p>
</li>
  <li><p>Lifting the output back to the outer context </p>
</li>
</ul>


  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:verifier_lift_context">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">51</span>
    <span class="definition_thmtitle">Verifier Context Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:verifier_lift_context">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.liftContext" class="lean_decl">Verifier.liftContext</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:reduction_lift_context">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">52</span>
    <span class="definition_thmtitle">Reduction Context Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:reduction_lift_context">#</a>
    
    
    <button class="modal"><svg  class="icon icon-mindmap "><use xlink:href="symbol-defs.svg#icon-mindmap"></use></svg>
</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Uses</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="chap-oracle_reductions.html#def:prover_lift_context">Definition 50</a></li>
          
          <li><a href="chap-oracle_reductions.html#def:verifier_lift_context">Definition 51</a></li>
          
        </ul>
    
      </div>
    </div>

    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.liftContext" class="lean_decl">Reduction.liftContext</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<h3 id="a0000000066">Conditions for Security Preservation</h3>
<p>For lifting to preserve security properties, the context lens must satisfy certain conditions. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:context_lens_is_complete">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">53</span>
    <span class="definition_thmtitle">Completeness-Preserving Context Lens</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:context_lens_is_complete">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ContextLens.IsComplete" class="lean_decl">ContextLens.IsComplete</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A context lens preserves completeness if it maintains relation satisfaction under projection and lifting.  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:statement_lens_is_sound">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">54</span>
    <span class="definition_thmtitle">Soundness-Preserving Statement Lens</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:statement_lens_is_sound">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/StatementLens.IsSound" class="lean_decl">StatementLens.IsSound</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A statement lens preserves soundness if it maps invalid statements to invalid statements.  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:statement_lens_is_rbr_sound">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">55</span>
    <span class="definition_thmtitle">RBR Soundness-Preserving Statement Lens</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:statement_lens_is_rbr_sound">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/StatementLens.IsRBRSound" class="lean_decl">StatementLens.IsRBRSound</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  For round-by-round soundness, we need a slightly relaxed soundness condition.  </p>

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:context_lens_is_knowledge_sound">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">56</span>
    <span class="definition_thmtitle">Knowledge Soundness-Preserving Context Lens</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:context_lens_is_knowledge_sound">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/ContextLens.IsKnowledgeSound" class="lean_decl">ContextLens.IsKnowledgeSound</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  <p>  A context lens preserves knowledge soundness if it maintains witness extractability.  </p>

  </div>
</div>
<h3 id="a0000000067">Security Preservation Theorems for Context Lifting</h3>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:lift_context_completeness">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">57</span>
    <span class="theorem_thmtitle">Completeness Preservation under Context Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:lift_context_completeness">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Reduction.liftContext_completeness" class="lean_decl">Reduction.liftContext_completeness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If a reduction satisfies completeness and the context lens is completeness-preserving, then the lifted reduction also satisfies completeness.  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:lift_context_soundness">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">58</span>
    <span class="theorem_thmtitle">Soundness Preservation under Context Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:lift_context_soundness">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.liftContext_soundness" class="lean_decl">Verifier.liftContext_soundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If a verifier satisfies soundness and the statement lens is soundness-preserving, then the lifted verifier also satisfies soundness.  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:lift_context_knowledge_soundness">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">59</span>
    <span class="theorem_thmtitle">Knowledge Soundness Preservation under Context Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:lift_context_knowledge_soundness">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.liftContext_knowledgeSoundness" class="lean_decl">Verifier.liftContext_knowledgeSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If a verifier satisfies knowledge soundness and the context lens is knowledge soundness-preserving, then the lifted verifier also satisfies knowledge soundness.  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:lift_context_rbr_soundness">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">60</span>
    <span class="theorem_thmtitle">RBR Soundness Preservation under Context Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:lift_context_rbr_soundness">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.liftContext_rbr_soundness" class="lean_decl">Verifier.liftContext_rbr_soundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If a verifier satisfies round-by-round soundness and the statement lens is RBR soundness-preserving, then the lifted verifier also satisfies round-by-round soundness.  </p>

  </div>
</div>
<div class="theorem_thmwrapper theorem-style-plain" id="thm:lift_context_rbr_knowledge_soundness">
  <div class="theorem_thmheading">
    <span class="theorem_thmcaption">
    Theorem
    </span>
    <span class="theorem_thmlabel">61</span>
    <span class="theorem_thmtitle">RBR Knowledge Soundness Preservation under Context Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#thm:lift_context_rbr_knowledge_soundness">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.liftContext_rbr_knowledgeSoundness" class="lean_decl">Verifier.liftContext_rbr_knowledgeSoundness</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="theorem_thmcontent">
  <p>  If a verifier satisfies round-by-round knowledge soundness and the context lens is knowledge soundness-preserving, then the lifted verifier also satisfies round-by-round knowledge soundness.  </p>

  </div>
</div>
<h3 id="a0000000068">Extractors and State Functions</h3>
<p>Context lifting also applies to extractors and state functions used in knowledge soundness and round-by-round soundness. </p>
<div class="definition_thmwrapper theorem-style-definition" id="def:straightline_extractor_lift_context">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">62</span>
    <span class="definition_thmtitle">Straightline Extractor Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:straightline_extractor_lift_context">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/StraightlineExtractor.liftContext" class="lean_decl">StraightlineExtractor.liftContext</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:rbr_extractor_lift_context">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">63</span>
    <span class="definition_thmtitle">Round-by-Round Extractor Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:rbr_extractor_lift_context">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/RBRExtractor.liftContext" class="lean_decl">RBRExtractor.liftContext</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<div class="definition_thmwrapper theorem-style-definition" id="def:state_function_lift_context">
  <div class="definition_thmheading">
    <span class="definition_thmcaption">
    Definition
    </span>
    <span class="definition_thmlabel">64</span>
    <span class="definition_thmtitle">State Function Lifting</span>
    <div class="thm_header_extras">

        </div>
    <div class="thm_header_hidden_extras">

    <a class="icon proof" href="chap-oracle_reductions.html#def:state_function_lift_context">#</a>
    
    
    
    <button class="modal lean">L∃∀N</button>
        <div class="modal-container">
      <div class="modal-content">
        <header>
          <h1>Lean declarations</h1>
          <button class="closebtn"><svg  class="icon icon-cross "><use xlink:href="symbol-defs.svg#icon-cross"></use></svg>
</button>
        </header>
        
        <ul class="uses">
          
          <li><a href="https://verified-zkevm.github.io/ArkLib/docs/find/#doc/Verifier.StateFunction.liftContext" class="lean_decl">Verifier.StateFunction.liftContext</a></li>
          
        </ul>
    
      </div>
    </div>

    
        </div>
  </div>
  <div class="definition_thmcontent">
  

  </div>
</div>
<p>These composition and lifting operators provide the essential building blocks for constructing complex oracle reductions from simpler components while preserving their security properties. </p>

</div> <!--main-text -->
</div> <!-- content-wrapper -->
</div> <!-- content -->
</div> <!-- wrapper -->

<nav class="prev_up_next">
  <svg  id="showmore-minus" class="icon icon-eye-minus showmore"><use xlink:href="symbol-defs.svg#icon-eye-minus"></use></svg>

  <svg  id="showmore-plus" class="icon icon-eye-plus showmore"><use xlink:href="symbol-defs.svg#icon-eye-plus"></use></svg>

  <a href="sect0001.html" title="Introduction"><svg  class="icon icon-arrow-left "><use xlink:href="symbol-defs.svg#icon-arrow-left"></use></svg>
</a>
  <a href="index.html" title="Formally Verified Arguments of Knowledge in Lean"><svg  class="icon icon-arrow-up "><use xlink:href="symbol-defs.svg#icon-arrow-up"></use></svg>
</a>
  <a href="chap-proof_systems.html" title="Proof Systems"><svg  class="icon icon-arrow-right "><use xlink:href="symbol-defs.svg#icon-arrow-right"></use></svg>
</a>
</nav>

<script type="text/javascript" src="js/jquery.min.js"></script>
<script type="text/javascript" src="js/plastex.js"></script>
<script type="text/javascript" src="js/svgxuse.js"></script>
<script type="text/javascript" src="js/js.cookie.min.js"></script>
<script type="text/javascript" src="js/showmore.js"></script>
</body>
</html>